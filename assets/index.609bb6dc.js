(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function t(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerpolicy&&(n.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?n.credentials="include":s.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(s){if(s.ep)return;s.ep=!0;const n=t(s);fetch(s.href,n)}})();const u=document.querySelector(".board"),y=document.querySelector(".loose-dialog"),C=document.querySelector(".controls");document.querySelector(".leaderboard");const m=document.querySelector(".information"),_=m.querySelector(".information__helper"),F=document.querySelector("#startGameButton"),T=document.querySelector("#showControls"),f=document.querySelector(".win-dialog");f.querySelector("#winDialogScore");const G=["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Enter"],l=[],v={dangers:{bat:"Du h\xF6r n\xE5nting fladdra",hole:"Du k\xE4nner ett vinddrag",wumpus:"Du k\xE4nner en konstig lukt"},info:{startGame:"Starta Spelet",failHole:"Du ramlade ner i ett h\xE5l och f\xF6rlorade spelet",failWumpus:"Du blev upp\xE4ten av Wumpus och f\xF6rlorade spelet"}},E={step:1,bat:2,arrow:3,wumpus:10,hole:5},b=[],a={floor1:"https://imagedelivery.net/3ecvmLCFkS-FijMWb0qFvQ/03636863-5fb8-41a2-8100-2344d9d54000/w=64",floor2:"https://imagedelivery.net/3ecvmLCFkS-FijMWb0qFvQ/36d9ffad-8037-4d4d-93a8-bd0d7913f000/w=64",hole:"https://imagedelivery.net/3ecvmLCFkS-FijMWb0qFvQ/7431f917-b3e8-4289-6493-53f649fecb00/w=64",playerDown:"https://imagedelivery.net/3ecvmLCFkS-FijMWb0qFvQ/0b24041e-d2eb-41d1-d651-313b4739d500/w=32",playerRight:"https://imagedelivery.net/3ecvmLCFkS-FijMWb0qFvQ/deff91a6-3dc7-4705-8a2d-97fc4da2ea00/w=32",playerLeft:"https://imagedelivery.net/3ecvmLCFkS-FijMWb0qFvQ/6734475c-874a-4177-5b4f-8c28630f3800/w=32",playerUp:"https://imagedelivery.net/3ecvmLCFkS-FijMWb0qFvQ/03d72ec3-be44-4851-1888-f19cadde4100/w=32",coin:"https://imagedelivery.net/3ecvmLCFkS-FijMWb0qFvQ/68a479b0-388d-42df-c370-31cbb4c5fe00/w=16",arrow:"https://imagedelivery.net/3ecvmLCFkS-FijMWb0qFvQ/24905c7e-15eb-487e-db64-7cd6ffea9500/w=16",wumpus:"https://imagedelivery.net/3ecvmLCFkS-FijMWb0qFvQ/8970db45-0232-4ae3-034b-748304e64a00/w=32",bat:"https://imagedelivery.net/3ecvmLCFkS-FijMWb0qFvQ/9abedca9-b076-4ea3-52e8-4b569d9ebd00/w=32"},i={isDebug:!1,isGameStarted:!1,isArrowMode:!1,currentPosition:0,previousPosition:0,arrows:5,score:0},q=c=>{i.score+=c;const t=m.querySelector(".information__score").querySelector(".information__score_points span");t.innerText=String(i.score)},x=()=>{_.innerHTML="";const{coord:c}=l[i.currentPosition],e=[],t=c[0]+1<=3?c[0]+1:0;e.push(l.find(r=>r.coord[0]===t&&r.coord[1]===c[1]));const o=c[0]-1>=0?c[0]-1:3;e.push(l.find(r=>r.coord[0]===o&&r.coord[1]===c[1]));const s=c[1]-1>=0?c[1]-1:4;e.push(l.find(r=>r.coord[0]===c[0]&&r.coord[1]===s));const n=c[1]+1<=4?c[1]+1:0;e.push(l.find(r=>r.coord[0]===c[0]&&r.coord[1]===n));for(const r of e)r!=null&&r.danger&&(_.innerHTML+=`<p>${v.dangers[r.danger]}</p>`)};let S=!1,k=!1;const p=()=>{m.classList.toggle("hidden"),F.innerHTML=v.info.startGame,u.innerHTML="",l.splice(0,l.length),i.isGameStarted=!1,i.currentPosition=0,i.previousPosition=0,i.score=0,S&&(S=!1,y.classList.toggle("hidden")),k&&(k=!1,f.classList.toggle("hidden"))},H=()=>{const c=document.querySelector(".leaderboard__entries"),e=b.length>0?b.sort((o,s)=>o.score-s.score):b,t=e.length<3?e.length:3;if(e.length>0)for(let o=0;o<t;o+=1)c.innerHTML+=`
      <li 
        class="leaderboard__entries_item" 
        data-id="${o+1}"
      >
        ${o+1}. 
        <span>
          ${e[o].name}
        </span>
        <span>
          ${e[o].score}
          <img src="${a.coin}" width="16" height="16" />
        </span>
      </li>`},P=c=>{if(c==="restart")p();else if(c==="win")k=!0,f.classList.toggle("hidden"),f.querySelector("button").addEventListener("click",()=>{var o;const t=(o=f.querySelector("input"))==null?void 0:o.value;if(t&&t!==""){const{score:s}=i;b.push({name:t,score:s}),H(),p()}});else{y.classList.toggle("hidden");const e=y.querySelector("p"),t=y.querySelector("button");e.innerText="",c==="hole"?(e.innerText=v.info.failHole,S=!0,t.addEventListener("click",p)):(e.innerText=v.info.failWumpus,S=!0,t.addEventListener("click",p))}},$=()=>{q(E.hole),P("hole")},D=()=>{i.previousPosition=i.currentPosition;let c=!1;for(;!c;){const e=Math.floor(Math.random()*l.length),t=l[e];if(e!==i.currentPosition&&t.danger===null){i.currentPosition=e;const s=u.querySelector(`[data-tile="${l[i.previousPosition].id}"]`).querySelector(".playerimg");s.src="data:image/svg+xml;charset=utf8,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%3E%3C/svg%3E";const n=u.querySelector(`[data-tile="${l[i.currentPosition].id}"]`),r=n.querySelector(".tileimg"),d=n.querySelector(".playerimg");d.src=a.playerDown,r.src=a.floor1,x(),q(E.bat),c=!0;break}}},j=()=>{q(E.wumpus),P("wumpus")},L={steppedInHole:$,steppedOnBat:D,steppedOnWumpus:j},h=c=>{const t=u.querySelector(`[data-tile="${l[i.previousPosition].id}"]`).querySelector(".playerimg");t.src="data:image/svg+xml;charset=utf8,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%3E%3C/svg%3E";const o=u.querySelector(`[data-tile="${l[i.currentPosition].id}"]`),s=o.querySelector(".tileimg"),n=o.querySelector(".dangerimg"),r=o.querySelector(".playerimg");switch(c){case"up":r.src=a.playerUp;break;case"down":r.src=a.playerDown;break;case"left":r.src=a.playerLeft;break;case"right":r.src=a.playerRight;break}l[i.currentPosition].danger==="hole"?(s.src=a.hole,L.steppedInHole()):(s.src=a.floor1,l[i.currentPosition].danger==="bat"?(n.src=a.bat,L.steppedOnBat()):l[i.currentPosition].danger==="wumpus"&&(n.src=a.wumpus,L.steppedOnWumpus())),x(),q(E.step)},w=c=>{const{coord:e}=l[i.currentPosition],t=[];switch(c){case"left":for(let o=0;o<3;o+=1){const s=e[1]-1>=0?e[1]-1:4;if(s-o>=0)t.push(l.find(n=>n.coord[0]===e[0]&&n.coord[1]===s-o));else{const n=s-(o-1)- -4;t.push(l.find(r=>r.coord[0]===e[0]&&r.coord[1]===n))}}break;case"right":for(let o=0;o<3;o+=1){const s=e[1]+1<=4?e[1]+1:0;if(s+o<=4)t.push(l.find(n=>n.coord[0]===e[0]&&n.coord[1]===s+o));else{let n=s-(o+1);n=n===0?n:n-1,n=n>=0?n:n*-1,t.push(l.find(r=>r.coord[0]===e[0]&&r.coord[1]===n))}}break;case"up":for(let o=0;o<3;o+=1){const s=e[0]-1>=0?e[0]-1:3;if(s-o>=0)t.push(l.find(n=>n.coord[0]===s-o&&n.coord[1]===e[1]));else{const n=s-(o-1)- -3;t.push(l.find(r=>r.coord[0]===n&&r.coord[1]===e[1]))}}break;case"down":for(let o=0;o<3;o+=1){const s=e[0]+1<=3?e[0]+1:0;if(s+o<=3)t.push(l.find(n=>n.coord[0]===s+o&&n.coord[1]===e[1]));else{let n=s-(o+1);n=n===-1?0:n,t.push(l.find(r=>r.coord[0]===n&&r.coord[1]===e[1]))}}break}i.isArrowMode=!1;for(const o of t)(o==null?void 0:o.danger)==="wumpus"&&P("win")},Q=()=>{i.isArrowMode||(i.isArrowMode=!0)},O=c=>{if(G.includes(c.key)&&i.isGameStarted){const e=l[i.currentPosition].coord;switch(i.previousPosition=i.currentPosition,c.key){case"ArrowLeft":i.isArrowMode?w("left"):(e[1]===0?i.currentPosition=l.findIndex(t=>t.coord[1]===4&&t.coord[0]===e[0]):i.currentPosition=l.findIndex(t=>t.coord[1]===e[1]-1&&t.coord[0]===e[0]),h("left"));break;case"ArrowRight":i.isArrowMode?w("right"):(e[1]===4?i.currentPosition=l.findIndex(t=>t.coord[1]===0&&t.coord[0]===e[0]):i.currentPosition=l.findIndex(t=>t.coord[1]===e[1]+1&&t.coord[0]===e[0]),h("right"));break;case"ArrowUp":i.isArrowMode?w("up"):(e[0]===0?i.currentPosition=l.findIndex(t=>t.coord[1]===e[1]&&t.coord[0]===3):i.currentPosition=l.findIndex(t=>t.coord[1]===e[1]&&t.coord[0]===e[0]-1),h("up"));break;case"ArrowDown":i.isArrowMode?w("down"):(e[0]===3?i.currentPosition=l.findIndex(t=>t.coord[1]===e[1]&&t.coord[0]===0):i.currentPosition=l.findIndex(t=>t.coord[1]===e[1]&&t.coord[0]===e[0]+1),h("down"));break;case"Enter":Q();break}}},B=()=>{const c=[4,5],e=.1,t=.2;let o=0,s=0,n=!1;for(let r=0;r<c[0];r+=1)for(let d=0;d<c[1];d+=1){const g=[r,d],A=g.toString().replace(",",""),W=null;l.push({coord:g,id:A,danger:W})}for(i.currentPosition=Math.floor(Math.random()*l.length);!n;){const r=Math.floor(Math.random()*l.length);if(r!==i.currentPosition){n=!0,l[r].danger="wumpus";break}}for(;o<c[0]*c[1]*e;){const r=Math.floor(Math.random()*l.length),d=l[r];if(r!==i.currentPosition&&d.danger===null&&(o+=1,l[r].danger="hole",o>=c[0]*c[1]/e))break}for(;s<c[0]*c[1]*t;){const r=Math.floor(Math.random()*l.length),d=l[r];if(r!==i.currentPosition&&d.danger===null&&(s+=1,l[r].danger="bat",s>=c[0]*c[1]/e))break}};let M=!1;const I=()=>{C.classList.toggle("hidden"),M=!M,M&&C.querySelector("button").addEventListener("click",I)},N=()=>{if(i.isGameStarted)P("restart");else{i.isGameStarted=!0,B(),x(),u.innerHTML="";for(const g of l)u.innerHTML+=`<div data-tile="${g.id}" class="board__tile">
          
          <img src="${a.floor2}" class="tileimg" width="64" height="64" />
          <img
            src="data:image/svg+xml;charset=utf8,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%3E%3C/svg%3E"
            class="playerimg"
            width="32"
            height="32"
          />
          <img
            src="data:image/svg+xml;charset=utf8,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%3E%3C/svg%3E"
            class="dangerimg"
            width="32"
            height="32"
          />
        </div>`;const c=u.querySelector(`[data-tile="${l[i.currentPosition].id}"]`),e=c.querySelector(".tileimg"),t=c.querySelector(".playerimg");e.src=a.floor1,t.src=a.playerDown,m.classList.toggle("hidden");const o=m.querySelector(".information__score"),s=o.querySelector(".information__score_points span"),n=o.querySelector(".information__score_points img"),r=o.querySelector(".information__score_arrows span"),d=o.querySelector(".information__score_arrows img");s.innerText=String(i.score),n.src=a.coin,r.innerText=String(i.arrows),d.src=a.arrow,F.innerHTML="Avsluta Spelet",document.addEventListener("keyup",O)}};T.addEventListener("click",I);F.addEventListener("click",N);
