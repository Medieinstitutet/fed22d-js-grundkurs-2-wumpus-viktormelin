(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function t(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerpolicy&&(r.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?r.credentials="include":l.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(l){if(l.ep)return;l.ep=!0;const r=t(l);fetch(l.href,r)}})();const f=document.querySelector(".board"),S=document.querySelector(".loose-dialog"),C=document.querySelector(".controls");document.querySelector(".leaderboard");const m=document.querySelector(".information"),_=m.querySelector(".information__helper"),x=document.querySelector("#startGameButton"),W=document.querySelector("#showControls"),p=document.querySelector(".win-dialog");p.querySelector("#winDialogScore");const D=["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Enter"],i=[],h={dangers:{bat:"Du h\xF6r n\xE5nting fladdra",hole:"Du k\xE4nner ett vinddrag",wumpus:"Du k\xE4nner en konstig lukt"},info:{startGame:"Starta Spelet",failHole:"Du ramlade ner i ett h\xE5l och f\xF6rlorade spelet",failWumpus:"Du blev upp\xE4ten av Wumpus och f\xF6rlorade spelet",failArrows:"Du fick slut p\xE5 pilar och kan inte l\xE4ngre vinna spelet"}},q={step:1,bat:2,arrow:3,wumpus:10,hole:5},E=[],u={floor1:"https://imagedelivery.net/3ecvmLCFkS-FijMWb0qFvQ/03636863-5fb8-41a2-8100-2344d9d54000/w=64",floor2:"https://imagedelivery.net/3ecvmLCFkS-FijMWb0qFvQ/36d9ffad-8037-4d4d-93a8-bd0d7913f000/w=64",hole:"https://imagedelivery.net/3ecvmLCFkS-FijMWb0qFvQ/7431f917-b3e8-4289-6493-53f649fecb00/w=64",playerDown:"https://imagedelivery.net/3ecvmLCFkS-FijMWb0qFvQ/0b24041e-d2eb-41d1-d651-313b4739d500/w=32",playerRight:"https://imagedelivery.net/3ecvmLCFkS-FijMWb0qFvQ/deff91a6-3dc7-4705-8a2d-97fc4da2ea00/w=32",playerLeft:"https://imagedelivery.net/3ecvmLCFkS-FijMWb0qFvQ/6734475c-874a-4177-5b4f-8c28630f3800/w=32",playerUp:"https://imagedelivery.net/3ecvmLCFkS-FijMWb0qFvQ/03d72ec3-be44-4851-1888-f19cadde4100/w=32",coin:"https://imagedelivery.net/3ecvmLCFkS-FijMWb0qFvQ/68a479b0-388d-42df-c370-31cbb4c5fe00/w=16",arrow:"https://imagedelivery.net/3ecvmLCFkS-FijMWb0qFvQ/24905c7e-15eb-487e-db64-7cd6ffea9500/w=16",wumpus:"https://imagedelivery.net/3ecvmLCFkS-FijMWb0qFvQ/8970db45-0232-4ae3-034b-748304e64a00/w=32",bat:"https://imagedelivery.net/3ecvmLCFkS-FijMWb0qFvQ/9abedca9-b076-4ea3-52e8-4b569d9ebd00/w=32"},n={isDebug:!1,isGameStarted:!1,isArrowMode:!1,currentPosition:0,previousPosition:0,arrows:5,score:0},k=s=>{n.score+=s;const t=m.querySelector(".information__score").querySelector(".information__score_points span");t.innerText=String(n.score)},F=()=>{_.innerHTML="";const{coord:s}=i[n.currentPosition],e=[],t=s[0]+1<=3?s[0]+1:0;e.push(i.find(o=>o.coord[0]===t&&o.coord[1]===s[1]));const a=s[0]-1>=0?s[0]-1:3;e.push(i.find(o=>o.coord[0]===a&&o.coord[1]===s[1]));const l=s[1]-1>=0?s[1]-1:4;e.push(i.find(o=>o.coord[0]===s[0]&&o.coord[1]===l));const r=s[1]+1<=4?s[1]+1:0;e.push(i.find(o=>o.coord[0]===s[0]&&o.coord[1]===r));for(const o of e)o!=null&&o.danger&&(_.innerHTML+=`<p>${h.dangers[o.danger]}</p>`)};let w=!1,M=!1;const g=()=>{m.classList.toggle("hidden"),x.innerHTML=h.info.startGame,f.innerHTML="",i.splice(0,i.length),n.isGameStarted=!1,n.currentPosition=0,n.previousPosition=0,n.score=0,w&&(w=!1,S.classList.toggle("hidden")),M&&(M=!1,p.classList.toggle("hidden"))},G=()=>{const s=document.querySelector(".leaderboard__entries"),e=E.length>0?E.sort((a,l)=>a.score-l.score):E,t=e.length<3?e.length:3;if(e.length>0)for(let a=0;a<t;a+=1)s.innerHTML+=`
      <li 
        class="leaderboard__entries_item" 
        data-id="${a+1}"
      >
        ${a+1}. 
        <span>
          ${e[a].name}
        </span>
        <span>
          ${e[a].score}
          <img src="${u.coin}" width="16" height="16" />
        </span>
      </li>`},y=s=>{if(s==="restart")g();else if(s==="win")M=!0,p.classList.toggle("hidden"),p.querySelector("button").addEventListener("click",()=>{var a;const t=(a=p.querySelector("input"))==null?void 0:a.value;if(t&&t!==""){const{score:l}=n;E.push({name:t,score:l}),G(),g()}});else{S.classList.toggle("hidden");const e=S.querySelector("p"),t=S.querySelector("button");e.innerText="",s==="hole"?(e.innerText=h.info.failHole,w=!0,t.addEventListener("click",g)):s==="wumpus"?(e.innerText=h.info.failWumpus,w=!0,t.addEventListener("click",g)):s==="noArrows"&&(e.innerText=h.info.failArrows,w=!0,t.addEventListener("click",g))}},H=()=>{k(q.hole),y("hole")},$=()=>{n.previousPosition=n.currentPosition;let s=!1;for(;!s;){const e=Math.floor(Math.random()*i.length),t=i[e];if(e!==n.currentPosition&&t.danger===null){n.currentPosition=e;const l=f.querySelector(`[data-tile="${i[n.previousPosition].id}"]`).querySelector(".playerimg");l.src="data:image/svg+xml;charset=utf8,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%3E%3C/svg%3E";const r=f.querySelector(`[data-tile="${i[n.currentPosition].id}"]`),o=r.querySelector(".tileimg"),c=r.querySelector(".playerimg");c.src=u.playerDown,o.src=u.floor1,F(),k(q.bat),s=!0;break}}},j=()=>{k(q.wumpus),y("wumpus")},L={steppedInHole:H,steppedOnBat:$,steppedOnWumpus:j},b=s=>{const t=f.querySelector(`[data-tile="${i[n.previousPosition].id}"]`).querySelector(".playerimg");t.src="data:image/svg+xml;charset=utf8,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%3E%3C/svg%3E";const a=f.querySelector(`[data-tile="${i[n.currentPosition].id}"]`),l=a.querySelector(".tileimg"),r=a.querySelector(".dangerimg"),o=a.querySelector(".playerimg");switch(s){case"up":o.src=u.playerUp;break;case"down":o.src=u.playerDown;break;case"left":o.src=u.playerLeft;break;case"right":o.src=u.playerRight;break}i[n.currentPosition].danger==="hole"?(l.src=u.hole,L.steppedInHole()):(l.src=u.floor1,i[n.currentPosition].danger==="bat"?(r.src=u.bat,L.steppedOnBat()):i[n.currentPosition].danger==="wumpus"&&(r.src=u.wumpus,L.steppedOnWumpus())),F(),k(q.step)},v=s=>{const{coord:e}=i[n.currentPosition],t=[];switch(s){case"left":for(let r=0;r<3;r+=1){const o=e[1]-1>=0?e[1]-1:4;if(o-r>=0)t.push(i.find(c=>c.coord[0]===e[0]&&c.coord[1]===o-r));else{const c=o-(r-1)- -4;t.push(i.find(d=>d.coord[0]===e[0]&&d.coord[1]===c))}}break;case"right":for(let r=0;r<3;r+=1){const o=e[1]+1<=4?e[1]+1:0;if(o+r<=4)t.push(i.find(c=>c.coord[0]===e[0]&&c.coord[1]===o+r));else{let c=o-(r+1);c=c===0?c:c-1,c=c>=0?c:c*-1,t.push(i.find(d=>d.coord[0]===e[0]&&d.coord[1]===c))}}break;case"up":for(let r=0;r<3;r+=1){const o=e[0]-1>=0?e[0]-1:3;if(o-r>=0)t.push(i.find(c=>c.coord[0]===o-r&&c.coord[1]===e[1]));else{const c=o-(r-1)- -3;t.push(i.find(d=>d.coord[0]===c&&d.coord[1]===e[1]))}}break;case"down":for(let r=0;r<3;r+=1){const o=e[0]+1<=3?e[0]+1:0;if(o+r<=3)t.push(i.find(c=>c.coord[0]===o+r&&c.coord[1]===e[1]));else{let c=o-(r+1);c=c===-1?0:c,t.push(i.find(d=>d.coord[0]===c&&d.coord[1]===e[1]))}}break}n.isArrowMode=!1;const l=m.querySelector(".information__score").querySelector(".information__score_arrows span");n.arrows-=1,l.innerText=String(n.arrows);for(const r of t)if((r==null?void 0:r.danger)==="wumpus"){y("win");return}n.arrows<=0&&y("noArrows")},Q=()=>{!n.isArrowMode&&n.arrows>0&&(n.isArrowMode=!0)},O=s=>{if(D.includes(s.key)&&n.isGameStarted){const e=i[n.currentPosition].coord;switch(n.previousPosition=n.currentPosition,s.key){case"ArrowLeft":n.isArrowMode?v("left"):(e[1]===0?n.currentPosition=i.findIndex(t=>t.coord[1]===4&&t.coord[0]===e[0]):n.currentPosition=i.findIndex(t=>t.coord[1]===e[1]-1&&t.coord[0]===e[0]),b("left"));break;case"ArrowRight":n.isArrowMode?v("right"):(e[1]===4?n.currentPosition=i.findIndex(t=>t.coord[1]===0&&t.coord[0]===e[0]):n.currentPosition=i.findIndex(t=>t.coord[1]===e[1]+1&&t.coord[0]===e[0]),b("right"));break;case"ArrowUp":n.isArrowMode?v("up"):(e[0]===0?n.currentPosition=i.findIndex(t=>t.coord[1]===e[1]&&t.coord[0]===3):n.currentPosition=i.findIndex(t=>t.coord[1]===e[1]&&t.coord[0]===e[0]-1),b("up"));break;case"ArrowDown":n.isArrowMode?v("down"):(e[0]===3?n.currentPosition=i.findIndex(t=>t.coord[1]===e[1]&&t.coord[0]===0):n.currentPosition=i.findIndex(t=>t.coord[1]===e[1]&&t.coord[0]===e[0]+1),b("down"));break;case"Enter":Q();break}}},B=()=>{const s=[4,5],e=.1,t=.2;let a=0,l=0,r=!1;for(let o=0;o<s[0];o+=1)for(let c=0;c<s[1];c+=1){const d=[o,c],I=d.toString().replace(",",""),T=null;i.push({coord:d,id:I,danger:T})}for(n.currentPosition=Math.floor(Math.random()*i.length);!r;){const o=Math.floor(Math.random()*i.length);if(o!==n.currentPosition){r=!0,i[o].danger="wumpus";break}}for(;a<s[0]*s[1]*e;){const o=Math.floor(Math.random()*i.length),c=i[o];if(o!==n.currentPosition&&c.danger===null&&(a+=1,i[o].danger="hole",a>=s[0]*s[1]/e))break}for(;l<s[0]*s[1]*t;){const o=Math.floor(Math.random()*i.length),c=i[o];if(o!==n.currentPosition&&c.danger===null&&(l+=1,i[o].danger="bat",l>=s[0]*s[1]/e))break}};let P=!1;const A=()=>{C.classList.toggle("hidden"),P=!P,P&&C.querySelector("button").addEventListener("click",A)},N=()=>{if(n.isGameStarted)y("restart");else{n.isGameStarted=!0,B(),F(),f.innerHTML="";for(const d of i)f.innerHTML+=`<div data-tile="${d.id}" class="board__tile">
          
          <img src="${u.floor2}" class="tileimg" width="64" height="64" />
          <img
            src="data:image/svg+xml;charset=utf8,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%3E%3C/svg%3E"
            class="playerimg"
            width="32"
            height="32"
          />
          <img
            src="data:image/svg+xml;charset=utf8,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%3E%3C/svg%3E"
            class="dangerimg"
            width="32"
            height="32"
          />
        </div>`;const s=f.querySelector(`[data-tile="${i[n.currentPosition].id}"]`),e=s.querySelector(".tileimg"),t=s.querySelector(".playerimg");e.src=u.floor1,t.src=u.playerDown,m.classList.toggle("hidden");const a=m.querySelector(".information__score"),l=a.querySelector(".information__score_points span"),r=a.querySelector(".information__score_points img"),o=a.querySelector(".information__score_arrows span"),c=a.querySelector(".information__score_arrows img");l.innerText=String(n.score),r.src=u.coin,o.innerText=String(n.arrows),c.src=u.arrow,x.innerHTML="Avsluta Spelet",document.addEventListener("keyup",O)}};W.addEventListener("click",A);x.addEventListener("click",N);
